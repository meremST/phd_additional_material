<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="752px" preserveAspectRatio="none" style="width:777px;height:752px;" version="1.1" viewBox="0 0 777 752" width="777px" zoomAndPan="magnify"><defs><filter height="300%" id="f7ttmnt2rzt9j" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f7ttmnt2rzt9j)" height="148.7969" style="stroke:#000000;stroke-width:2.0;" width="753.5" x="10" y="505.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="39" x2="39" y1="88.2969" y2="745.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="319.5" x2="319.5" y1="88.2969" y2="745.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="410.5" x2="410.5" y1="88.2969" y2="745.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="712.5" x2="712.5" y1="88.2969" y2="745.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="20" y="84.9951">Alice</text><ellipse cx="39" cy="15" fill="#FEFECE" filter="url(#f7ttmnt2rzt9j)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M39,23 L39,50 M26,31 L52,31 M39,50 L26,65 M39,50 L52,65 " fill="none" filter="url(#f7ttmnt2rzt9j)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="271.5" y="84.9951">Manufacturer</text><ellipse cx="320" cy="15" fill="#FEFECE" filter="url(#f7ttmnt2rzt9j)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M320,23 L320,50 M307,31 L333,31 M320,50 L307,65 M320,50 L333,65 " fill="none" filter="url(#f7ttmnt2rzt9j)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f7ttmnt2rzt9j)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="61" x="378.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="385.5" y="72.9951">SoC[0]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="672.5" y="84.9951">Blockchain</text><ellipse cx="713" cy="15" fill="#FEFECE" filter="url(#f7ttmnt2rzt9j)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M713,23 L713,50 M700,31 L726,31 M713,50 L700,65 M713,50 L726,65 " fill="none" filter="url(#f7ttmnt2rzt9j)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FFFFFF" filter="url(#f7ttmnt2rzt9j)" height="40.2656" style="stroke:#000000;stroke-width:2.0;" width="484" x="268.5" y="98.2969"/><polygon fill="#EEEEEE" points="268.5,98.2969,334.5,98.2969,334.5,105.2969,324.5,115.2969,268.5,115.2969,268.5,98.2969" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="281.5" y="112.3638">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="474.5" y="131.3638">Provisioning</text><line style="stroke:#008000;stroke-width:1.0;" x1="39" x2="49" y1="164.6953" y2="160.6953"/><line style="stroke:#008000;stroke-width:1.0;" x1="39" x2="49" y1="164.6953" y2="168.6953"/><line style="stroke:#008000;stroke-width:1.0;" x1="318" x2="308" y1="164.6953" y2="160.6953"/><line style="stroke:#008000;stroke-width:1.0;" x1="318" x2="308" y1="164.6953" y2="168.6953"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="39" x2="319" y1="164.6953" y2="164.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="175" x="88" y="159.6294">physical/commercial trades</text><polygon fill="#FBFB77" filter="url(#f7ttmnt2rzt9j)" points="351,177.6953,470,177.6953,480,188.6953,470,200.6953,351,200.6953,341,188.6953,351,177.6953" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="353" y="193.7622">is at Alice location</text><polygon fill="#A80036" points="50,238.0938,40,242.0938,50,246.0938,46,242.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44" x2="319" y1="242.0938" y2="242.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="56" y="221.895">sendUidAndAccProof(batchRoot,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="72" y="237.0278">proofuid0, pkSoc0, pkMan, script)</text><polygon fill="#A80036" points="399,267.2266,409,271.2266,399,275.2266,403,271.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="39" x2="405" y1="271.2266" y2="271.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="46" y="266.1606">getScript()</text><polygon fill="#A80036" points="50,296.3594,40,300.3594,50,304.3594,46,300.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44" x2="410" y1="300.3594" y2="300.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="56" y="295.2935">scriptResp(signUid0)</text><polygon fill="#A80036" points="701,325.4922,711,329.4922,701,333.4922,705,329.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="39" x2="707" y1="329.4922" y2="329.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="46" y="324.4263">getBatchInfo(contractAddr, batchAddr)</text><polygon fill="#A80036" points="50,354.625,40,358.625,50,362.625,46,358.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44" x2="712" y1="358.625" y2="358.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="56" y="353.5591">batchInfoResp(batchRootProof)</text><polygon fill="#A80036" points="308,398.8906,318,402.8906,308,406.8906,312,402.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="39" x2="314" y1="402.8906" y2="402.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="46" y="382.6919">sendNewBatch(salt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="228" x="62" y="397.8247">newBatchRoot, newBatchRootProof)</text><polygon fill="#A80036" points="701,428.0234,711,432.0234,701,436.0234,705,432.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="320" x2="707" y1="432.0234" y2="432.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="369" x="327" y="426.9575">divideBatch(newOwnershipProof, contractAddr,batchAddr)</text><polygon fill="#A80036" points="331,457.1563,321,461.1563,331,465.1563,327,461.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="325" x2="712" y1="461.1563" y2="461.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="337" y="456.0903">divideResp(newBatchAddr)</text><polygon fill="#A80036" points="50,486.2891,40,490.2891,50,494.2891,46,490.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44" x2="319" y1="490.2891" y2="490.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="56" y="485.2231">sendProof(contractAddr, newBatchAddr)</text><path d="M10,505.2891 L279,505.2891 L279,512.2891 L269,522.2891 L10,522.2891 L10,505.2891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="148.7969" style="stroke:#000000;stroke-width:2.0;" width="753.5" x="10" y="505.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="224" x="25" y="518.356">Actual SoC ownership transfer</text><polygon fill="#A80036" points="701,539.5547,711,543.5547,701,547.5547,705,543.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="39" x2="707" y1="543.5547" y2="543.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="46" y="538.4888">getBatchInfo(contractAddr, newBatchAddr)</text><polygon fill="#A80036" points="50,568.6875,40,572.6875,50,576.6875,46,572.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44" x2="712" y1="572.6875" y2="572.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="56" y="567.6216">batchInfoResp(newOwnershipProof)</text><polygon fill="#A80036" points="399,612.9531,409,616.9531,399,620.9531,403,616.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="39" x2="405" y1="616.9531" y2="616.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="46" y="596.7544">updateScript(newOwnershipProof,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="308" x="62" y="611.8872">salt, newBatchRoot, newBatchRootProof,pkAlice)</text><polygon fill="#A80036" points="50,642.0859,40,646.0859,50,650.0859,46,646.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44" x2="410" y1="646.0859" y2="646.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="56" y="641.02">scriptResp(signedScript)</text><line style="stroke:#008000;stroke-width:1.0;" x1="39" x2="49" y1="682.2188" y2="678.2188"/><line style="stroke:#008000;stroke-width:1.0;" x1="39" x2="49" y1="682.2188" y2="686.2188"/><line style="stroke:#008000;stroke-width:1.0;" x1="318" x2="308" y1="682.2188" y2="678.2188"/><line style="stroke:#008000;stroke-width:1.0;" x1="318" x2="308" y1="682.2188" y2="686.2188"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="39" x2="319" y1="682.2188" y2="682.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="120" x="88" y="677.1528">commercial trades</text><rect fill="#FFFFFF" filter="url(#f7ttmnt2rzt9j)" height="40.2656" style="stroke:#000000;stroke-width:2.0;" width="425.5" x="17" y="690.2188"/><polygon fill="#EEEEEE" points="17,690.2188,83,690.2188,83,697.2188,73,707.2188,17,707.2188,17,690.2188" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="30" y="704.2856">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="151.25" y="723.2856">ConfigurationModification</text><!--MD5=[ca810a54c5dc26bd4fefb420835d7113]
@startuml
hide footbox

actor Alice
actor Manufacturer
participant "SoC[0]" as SoC_0
'collections "SoC[1..N]" as SoC_N
actor Blockchain

ref over Manufacturer, Blockchain : Provisioning

Alice <<-[#green]->> Manufacturer : //        physical/commercial trades//

hnote over SoC_0
 is at Alice location
endhnote

'group Chip ownership modification
Manufacturer -> Alice : sendUidAndAccProof(batchRoot,\n    proofuid0, pkSoc0, pkMan, script)

Alice -> SoC_0 : getScript()

SoC_0 -> Alice : scriptResp(signUid0)

Alice -> Blockchain : getBatchInfo(contractAddr, batchAddr)
Blockchain -> Alice : batchInfoResp(batchRootProof)

Alice -> Manufacturer : sendNewBatch(salt,\n    newBatchRoot, newBatchRootProof)

Manufacturer -> Blockchain : divideBatch(newOwnershipProof, contractAddr,batchAddr)

Blockchain  -> Manufacturer : divideResp(newBatchAddr)

Manufacturer -> Alice : sendProof(contractAddr, newBatchAddr)

group Actual SoC ownership transfer
Alice -> Blockchain : getBatchInfo(contractAddr, newBatchAddr)
Blockchain -> Alice : batchInfoResp(newOwnershipProof)


Alice -> SoC_0: updateScript(newOwnershipProof,\n    salt, newBatchRoot, newBatchRootProof,pkAlice)

SoC_0 -> Alice : scriptResp(signedScript)
end

Alice <<-[#green]->> Manufacturer : //        commercial trades//

ref over Alice, SoC_0 : ConfigurationModification
@enduml

@startuml
hide footbox

actor Alice
actor Manufacturer
participant "SoC[0]" as SoC_0
actor Blockchain

ref over Manufacturer, Blockchain : Provisioning

Alice <<-[#green]->> Manufacturer : //        physical/commercial trades//

hnote over SoC_0
 is at Alice location
endhnote

Manufacturer -> Alice : sendUidAndAccProof(batchRoot,\n    proofuid0, pkSoc0, pkMan, script)

Alice -> SoC_0 : getScript()

SoC_0 -> Alice : scriptResp(signUid0)

Alice -> Blockchain : getBatchInfo(contractAddr, batchAddr)
Blockchain -> Alice : batchInfoResp(batchRootProof)

Alice -> Manufacturer : sendNewBatch(salt,\n    newBatchRoot, newBatchRootProof)

Manufacturer -> Blockchain : divideBatch(newOwnershipProof, contractAddr,batchAddr)

Blockchain  -> Manufacturer : divideResp(newBatchAddr)

Manufacturer -> Alice : sendProof(contractAddr, newBatchAddr)

group Actual SoC ownership transfer
Alice -> Blockchain : getBatchInfo(contractAddr, newBatchAddr)
Blockchain -> Alice : batchInfoResp(newOwnershipProof)


Alice -> SoC_0: updateScript(newOwnershipProof,\n    salt, newBatchRoot, newBatchRootProof,pkAlice)

SoC_0 -> Alice : scriptResp(signedScript)
end

Alice <<-[#green]->> Manufacturer : //        commercial trades//

ref over Alice, SoC_0 : ConfigurationModification
@enduml

PlantUML version 1.2020.22(Sun Dec 06 09:36:27 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>